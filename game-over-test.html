<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸æˆç»“æŸæ£€æµ‹æµ‹è¯• - æ–¹å—æ‹¼å›¾æ¸¸æˆ</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #ffffff;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #00d4ff;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        .test-info {
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid #00d4ff;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-info h2 {
            color: #39ff14;
            margin-top: 0;
        }
        
        .test-steps {
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid #39ff14;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-steps h3 {
            color: #ffaa00;
            margin-top: 0;
        }
        
        .test-steps ol {
            padding-left: 20px;
        }
        
        .test-steps li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .highlight {
            color: #ff4444;
            font-weight: bold;
        }
        
        .success {
            color: #39ff14;
            font-weight: bold;
        }
        
        .warning {
            color: #ffaa00;
            font-weight: bold;
        }
        
        #gameContainer {
            width: 100%;
            height: 600px;
            border: 2px solid #666666;
            border-radius: 10px;
            background: #000000;
            margin: 20px auto;
            display: block;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            border: none;
            color: white;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .status {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(26, 26, 26, 0.8);
            border-radius: 10px;
            border: 1px solid #666666;
        }
        
        .status-item {
            display: inline-block;
            margin: 0 20px;
            padding: 5px 10px;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® æ¸¸æˆç»“æŸæ£€æµ‹æµ‹è¯•</h1>
        
        <div class="test-info">
            <h2>ğŸ” æµ‹è¯•ç›®æ ‡</h2>
            <p>éªŒè¯æ¸¸æˆå¼•æ“èƒ½å¤Ÿæ­£ç¡®æ£€æµ‹æ¸¸æˆç»“æŸçŠ¶æ€ï¼šå½“æ‰€æœ‰å€™é€‰æ–¹å—éƒ½æ— æ³•æ”¾ç½®åˆ°æ¸¸æˆæ¿ä¸Šæ—¶ï¼Œè‡ªåŠ¨è§¦å‘æ¸¸æˆç»“æŸç•Œé¢ã€‚</p>
        </div>
        
        <div class="test-steps">
            <h3>ğŸ“‹ æµ‹è¯•æ­¥éª¤</h3>
            <ol>
                <li>ç‚¹å‡»"<span class="success">å¼€å§‹æµ‹è¯•</span>"æŒ‰é’®å¯åŠ¨æ¸¸æˆ</li>
                <li>é€‰æ‹©ä»»æ„æ¸¸æˆæ¨¡å¼å’Œéš¾åº¦</li>
                <li>å¼€å§‹æ”¾ç½®æ–¹å—ï¼Œ<span class="warning">æ•…æ„è®©æ¸¸æˆæ¿å˜å¾—æ‹¥æŒ¤</span></li>
                <li>å½“å€™é€‰æ–¹å—æ— æ³•æ”¾ç½®æ—¶ï¼Œåº”è¯¥<span class="highlight">è‡ªåŠ¨å¼¹å‡ºæ¸¸æˆç»“æŸç•Œé¢</span></li>
                <li>éªŒè¯æ¸¸æˆç»“æŸç•Œé¢æ˜¾ç¤ºï¼š
                    <ul>
                        <li>æœ€ç»ˆåˆ†æ•°</li>
                        <li>æ¸¸æˆæ¨¡å¼</li>
                        <li>æœ€é«˜è¿å‡»ï¼ˆå¦‚æœæœ‰ï¼‰</li>
                        <li>é‡æ–°å¼€å§‹å’Œè¿”å›ä¸»èœå•æŒ‰é’®</li>
                    </ul>
                </li>
                <li>æµ‹è¯•æŒ‰é’®åŠŸèƒ½æ˜¯å¦æ­£å¸¸</li>
            </ol>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="startTest()">ğŸš€ å¼€å§‹æµ‹è¯•</button>
            <button class="btn" onclick="resetTest()">ğŸ”„ é‡ç½®æµ‹è¯•</button>
            <button class="btn" onclick="fillBoard()">âš¡ å¿«é€Ÿå¡«å……æ¸¸æˆæ¿</button>
        </div>
        
        <div class="status">
            <div class="status-item">
                <strong>æµ‹è¯•çŠ¶æ€:</strong> <span id="testStatus">ç­‰å¾…å¼€å§‹</span>
            </div>
            <div class="status-item">
                <strong>æ¸¸æˆçŠ¶æ€:</strong> <span id="gameStatus">æœªå¼€å§‹</span>
            </div>
            <div class="status-item">
                <strong>å€™é€‰æ–¹å—:</strong> <span id="candidateCount">0</span>
            </div>
        </div>
        
        <canvas id="gameContainer"></canvas>
        
        <div class="test-info">
            <h2>âœ… é¢„æœŸç»“æœ</h2>
            <ul>
                <li><span class="success">è‡ªåŠ¨æ£€æµ‹ï¼š</span>å½“æ‰€æœ‰å€™é€‰æ–¹å—éƒ½æ— æ³•æ”¾ç½®æ—¶ï¼Œæ¸¸æˆè‡ªåŠ¨ç»“æŸ</li>
                <li><span class="success">ç•Œé¢æ˜¾ç¤ºï¼š</span>å¼¹å‡ºæ¸¸æˆç»“æŸç•Œé¢ï¼Œæ˜¾ç¤ºå®Œæ•´çš„æ¸¸æˆç»Ÿè®¡ä¿¡æ¯</li>
                <li><span class="success">æŒ‰é’®åŠŸèƒ½ï¼š</span>é‡æ–°å¼€å§‹å’Œè¿”å›ä¸»èœå•æŒ‰é’®æ­£å¸¸å·¥ä½œ</li>
                <li><span class="success">çŠ¶æ€ç®¡ç†ï¼š</span>æ¸¸æˆçŠ¶æ€æ­£ç¡®è®¾ç½®ä¸ºå·²ç»“æŸ</li>
            </ul>
        </div>
    </div>

    <script type="module">
        import { GameApp } from './src/app.js'
        
        let gameApp = null
        let testStarted = false
        
        window.startTest = function() {
            if (testStarted) {
                console.log('æµ‹è¯•å·²ç»å¼€å§‹')
                return
            }
            
            testStarted = true
            updateStatus('testStatus', 'æ­£åœ¨åˆå§‹åŒ–...')
            updateStatus('gameStatus', 'åˆå§‹åŒ–ä¸­')
            
            try {
                // åˆ›å»ºæ¸¸æˆåº”ç”¨
                gameApp = new GameApp()
                
                // åˆå§‹åŒ–æ¸¸æˆ
                const canvas = document.getElementById('gameContainer')
                gameApp.init(canvas, 1024, 600)
                
                // è®¾ç½®å…¨å±€å¼•ç”¨
                window.gameApp = gameApp
                
                updateStatus('testStatus', 'æµ‹è¯•è¿›è¡Œä¸­')
                updateStatus('gameStatus', 'ç­‰å¾…æ¨¡å¼é€‰æ‹©')
                
                // ç›‘å¬æ¸¸æˆçŠ¶æ€å˜åŒ–
                monitorGameState()
                
                console.log('ğŸ® æ¸¸æˆç»“æŸæ£€æµ‹æµ‹è¯•å·²å¯åŠ¨')
                console.log('ğŸ“ è¯·é€‰æ‹©æ¸¸æˆæ¨¡å¼å’Œéš¾åº¦å¼€å§‹æµ‹è¯•')
                
            } catch (error) {
                console.error('âŒ æµ‹è¯•å¯åŠ¨å¤±è´¥:', error)
                updateStatus('testStatus', 'å¯åŠ¨å¤±è´¥')
                updateStatus('gameStatus', 'é”™è¯¯')
            }
        }
        
        window.resetTest = function() {
            if (gameApp) {
                gameApp.destroy()
                gameApp = null
            }
            testStarted = false
            updateStatus('testStatus', 'å·²é‡ç½®')
            updateStatus('gameStatus', 'æœªå¼€å§‹')
            updateStatus('candidateCount', '0')
            
            // æ¸…ç©ºç”»å¸ƒ
            const canvas = document.getElementById('gameContainer')
            const ctx = canvas.getContext('2d')
            if (ctx) {
                ctx.clearRect(0, 0, canvas.width, canvas.height)
            }
            
            console.log('ğŸ”„ æµ‹è¯•å·²é‡ç½®')
        }
        
        window.fillBoard = function() {
            if (!gameApp || !gameApp.gameEngine || !gameApp.gameEngine.gameState) {
                console.log('âš ï¸ æ¸¸æˆæœªå¼€å§‹ï¼Œæ— æ³•å¡«å……æ¸¸æˆæ¿')
                return
            }
            
            const gameState = gameApp.gameEngine.gameState
            const board = gameState.board
            
            // å¡«å……å¤§éƒ¨åˆ†æ¸¸æˆæ¿ï¼Œç•™ä¸‹ä¸€äº›ä¸è§„åˆ™çš„ç©ºéš™
            for (let y = 0; y < board.height; y++) {
                for (let x = 0; x < board.width; x++) {
                    // éšæœºå¡«å……çº¦80%çš„æ ¼å­ï¼Œåˆ›é€ ä¸è§„åˆ™çš„ç©ºéš™
                    if (Math.random() < 0.8) {
                        board.grid[y][x] = 1 // FILLED
                    }
                }
            }
            
            // æ›´æ–°æ¸¸æˆæ˜¾ç¤º
            if (gameApp.sceneManager) {
                gameApp.sceneManager.setGameState(gameState)
            }
            
            console.log('âš¡ æ¸¸æˆæ¿å·²å¿«é€Ÿå¡«å……ï¼Œå€™é€‰æ–¹å—åº”è¯¥å¾ˆå¿«æ— æ³•æ”¾ç½®')
            updateStatus('gameStatus', 'æ¸¸æˆæ¿å·²å¡«å……')
        }
        
        function updateStatus(elementId, text) {
            const element = document.getElementById(elementId)
            if (element) {
                element.textContent = text
            }
        }
        
        function monitorGameState() {
            setInterval(() => {
                if (gameApp && gameApp.gameEngine && gameApp.gameEngine.gameState) {
                    const gameState = gameApp.gameEngine.gameState
                    
                    // æ›´æ–°å€™é€‰æ–¹å—æ•°é‡
                    updateStatus('candidateCount', gameState.candidateBlocks.length)
                    
                    // æ›´æ–°æ¸¸æˆçŠ¶æ€
                    if (gameState.isGameOver) {
                        updateStatus('gameStatus', 'æ¸¸æˆç»“æŸ')
                        updateStatus('testStatus', 'æµ‹è¯•å®Œæˆ - æ¸¸æˆç»“æŸæ£€æµ‹æˆåŠŸï¼')
                    } else if (gameState.candidateBlocks.length > 0) {
                        updateStatus('gameStatus', 'æ¸¸æˆè¿›è¡Œä¸­')
                    }
                }
            }, 500)
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ”§ æ¸¸æˆç»“æŸæ£€æµ‹æµ‹è¯•é¡µé¢å·²åŠ è½½')
            console.log('ğŸ“‹ ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŒ‰é’®å¼€å§‹éªŒè¯æ¸¸æˆç»“æŸæ£€æµ‹åŠŸèƒ½')
        })
    </script>
</body>
</html> 